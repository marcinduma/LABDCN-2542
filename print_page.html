
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="ACI Anywhere using Cisco Cloud Network Controller (formerly Cloud APIC) with Practice Use-cases">
      
      
        <meta name="author" content="Marcin Duma & Karol Okraska">
      
      
      <link rel="icon" href="assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.3.0, mkdocs-material-8.2.16">
    
    
      
        <title>Print Site - CiscoLive EMEA 2023 --- LABDCN-2542</title>
      
    
    
      <link rel="stylesheet" href="assets/stylesheets/main.1c3799f8.min.css">
      
        
        <link rel="stylesheet" href="assets/stylesheets/palette.cc9b2e1e.min.css">
        
      
    
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="css/print-site-enum-headings1.css">
    
      <link rel="stylesheet" href="css/print-site-enum-headings2.css">
    
      <link rel="stylesheet" href="css/print-site-enum-headings3.css">
    
      <link rel="stylesheet" href="css/print-site-enum-headings4.css">
    
      <link rel="stylesheet" href="css/print-site-enum-headings5.css">
    
      <link rel="stylesheet" href="css/print-site-enum-headings6.css">
    
      <link rel="stylesheet" href="css/print-site.css">
    
      <link rel="stylesheet" href="css/print-site-material.css">
    
    <script>__md_scope=new URL("/",location),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
  
        <script type="text/javascript">
        document.addEventListener('DOMContentLoaded', function () {
            remove_material_navigation();remove_mkdocs_theme_navigation();generate_toc();
        })
        </script>
        </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="" data-md-color-primary="none" data-md-color-accent="none">
  
    
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="index.html" title="CiscoLive EMEA 2023 --- LABDCN-2542" class="md-header__button md-logo" aria-label="CiscoLive EMEA 2023 --- LABDCN-2542" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            CiscoLive EMEA 2023 --- LABDCN-2542
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Print Site
            
          </span>
        </div>
      </div>
    </div>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" aria-label="Clear" tabindex="-1">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="index.html" title="CiscoLive EMEA 2023 --- LABDCN-2542" class="md-nav__button md-logo" aria-label="CiscoLive EMEA 2023 --- LABDCN-2542" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    CiscoLive EMEA 2023 --- LABDCN-2542
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="index.html" class="md-nav__link">
        Home
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="LAB_access-RDP.html" class="md-nav__link">
        Lab Access
      </a>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3" type="checkbox" id="__nav_3" >
      
      
      
      
        <label class="md-nav__link" for="__nav_3">
          Explore Nexus Dashboard
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Explore Nexus Dashboard" data-md-level="1">
        <label class="md-nav__title" for="__nav_3">
          <span class="md-nav__icon md-icon"></span>
          Explore Nexus Dashboard
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="nd.html" class="md-nav__link">
        Dashboard overview
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="ndo.html" class="md-nav__link">
        Orchestrator overview
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="infra-config.html" class="md-nav__link">
        Sites connectivity
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="object-map.html" class="md-nav__link">
        ACI to Public Cloud Object mapping
      </a>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_5" type="checkbox" id="__nav_5" >
      
      
      
      
        <label class="md-nav__link" for="__nav_5">
          Tenant configuration
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Tenant configuration" data-md-level="1">
        <label class="md-nav__title" for="__nav_5">
          <span class="md-nav__icon md-icon"></span>
          Tenant configuration
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="ndo-tenant.html" class="md-nav__link">
        NDO Tenant configuration
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="aws-trust.html" class="md-nav__link">
        AWS Trust
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_6" type="checkbox" id="__nav_6" >
      
      
      
      
        <label class="md-nav__link" for="__nav_6">
          Use-cases
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Use-cases" data-md-level="1">
        <label class="md-nav__title" for="__nav_6">
          <span class="md-nav__icon md-icon"></span>
          Use-cases
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="use-case1.html" class="md-nav__link">
        Use-case 01 - Stretched VRF
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="use-case2.html" class="md-nav__link">
        Use-case 02 - Internet Gateway
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_7" type="checkbox" id="__nav_7" >
      
      
      
      
        <label class="md-nav__link" for="__nav_7">
          Appendixes
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Appendixes" data-md-level="1">
        <label class="md-nav__title" for="__nav_7">
          <span class="md-nav__icon md-icon"></span>
          Appendixes
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_7_1" type="checkbox" id="__nav_7_1" >
      
      
      
      
        <label class="md-nav__link" for="__nav_7_1">
          Lab details
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Lab details" data-md-level="2">
        <label class="md-nav__title" for="__nav_7_1">
          <span class="md-nav__icon md-icon"></span>
          Lab details
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="pod1x.md" class="md-nav__link">
        POD-01
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="pod2x.md" class="md-nav__link">
        POD-02
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="pod3x.md" class="md-nav__link">
        POD-03
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="pod4x.md" class="md-nav__link">
        POD-04
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="pod5x.md" class="md-nav__link">
        POD-05
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="pod6x.md" class="md-nav__link">
        POD-06
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="resources.html" class="md-nav__link">
        Resources
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="print_page/" class="md-nav__link">
        PRINT version
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#" class="md-nav__link">
    1. Home
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#lab_access-rdp" class="md-nav__link">
    2. Lab Access
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#section-explore-nexus-dashboard" class="md-nav__link">
    I. Explore Nexus Dashboard
  </a>
  
    <nav class="md-nav" aria-label="I. Explore Nexus Dashboard">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#nd" class="md-nav__link">
    3. Dashboard overview
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ndo" class="md-nav__link">
    4. Orchestrator overview
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#infra-config" class="md-nav__link">
    5. Sites connectivity
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#object-map" class="md-nav__link">
    6. ACI to Public Cloud Object mapping
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#section-tenant-configuration" class="md-nav__link">
    II. Tenant configuration
  </a>
  
    <nav class="md-nav" aria-label="II. Tenant configuration">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#ndo-tenant" class="md-nav__link">
    7. NDO Tenant configuration
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#aws-trust" class="md-nav__link">
    8. AWS Trust
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#section-use-cases" class="md-nav__link">
    III. Use-cases
  </a>
  
    <nav class="md-nav" aria-label="III. Use-cases">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#use-case1" class="md-nav__link">
    9. Use-case 01 - Stretched VRF
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#use-case2" class="md-nav__link">
    10. Use-case 02 - Internet Gateway
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#section-appendixes" class="md-nav__link">
    IV. Appendixes
  </a>
  
    <nav class="md-nav" aria-label="IV. Appendixes">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#resources" class="md-nav__link">
    11. Resources
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content" data-md-component="content">
            <article class="md-content__inner md-typeset">
              
                


<div id="print-site-page" class="print-site-enumerate-headings print-site-enumerate-figures">
        <section id="print-site-cover-page">
            <div>

    
        <h1>CiscoLive EMEA 2023 --- LABDCN-2542</h1>
    

</div>


<table>

    
    <tr>
        <td>Description</td>
        <td>ACI Anywhere using Cisco Cloud Network Controller (formerly Cloud APIC) with Practice Use-cases</td>
    </tr>
    

    
    <tr>
        <td>Author(s)</td>
        <td>Marcin Duma & Karol Okraska</td>
    </tr>
    

    

    

</table>
        </section>
        
        <div id="print-site-banner">
            <p>
<center><em>This box will disappear when printing</em></center>
</p>
<p>
<center> This page has combined all site pages into one. You can export to PDF using <b>File > Print > Save as PDF</b>.</center>
</p>
        </div>
        
        <section class="print-page">
            <div id="print-page-toc" data-toc-depth="3">
                <nav role='navigation' class='print-page-toc-nav'>
                <h1 class='print-page-toc-title'>Table of Contents</h1>
                </nav>
            </div>
        </section>
        <section class="print-page" id="index"><h1 id="index-welcome-to-ciscolive-2023-walk-in-lab">Welcome to CiscoLive 2023 - Walk in Lab</h1>
<p>Speakers:</p>
<p><em>Karol Okraska</em>, CX Delivery Architect, Cisco Systems, Inc.</p>
<p><em>Marcin Duma</em>, CX Delivery Architect, Cisco Systems, Inc.</p>
<h2 id="index-cisco-aci-support-of-public-cloud-infrastructure">Cisco ACI support of Public Cloud infrastructure</h2>
<p>Cisco Cloud Network Controller (formerly Cloud APIC) provides enterprises with networking tools necessary to accelerate their hybrid-cloud and/or multicloud journey.</p>
<p>Utilizing cloud-native constructs, the solution enables automation that accelerates infrastructure deployment and governance and simplifies management to easily connect workloads across multicloud environments. The Cisco Cloud Network Controller vision is to support enhanced observability, operations, and troubleshooting across the entire environment.</p>
<p>Cisco Cloud Network Controller enables:</p>
<p>●      Seamless connectivity for any workload at scale across any location</p>
<p>●      Operational simplicity and visibility across a vast multisite, multicloud</p>
<p>●      Data-center network</p>
<p>●      Easy L4-7 services integration</p>
<p>●      Consistent security and segmentation</p>
<p>●      Business continuity and disaster recovery</p>
<h2 id="index-cisco-cloud-network-solution-components">Cisco Cloud Network Solution components:</h2>
<p>Cisco Cloud Network Controller is the main architectural component of this multicloud solution. It is the unified point of automation and management for the solution fabric including network and security policy, health monitoring, and optimizes performance and agility. The complete solution includes:</p>
<p>●      Cisco Cloud Network Controller ( called CNC later in labguide) (deployed in each Public Cloud which is to be managed) </p>
<p>●      Cisco Nexus Dashboard (in our lab deployed on-prem) - Multicloud networking orchestration and policy management, disaster recovery, and high availability, as well as provisioning and health monitoring.</p>
<p>●      Cisco Catalyst® 8000V - deployed in Public Clouds, allowing for communication with other Clouds or on-premises datacenter. Responsible for traffic secuirty and end to end policy enforcement. </p>
<h2 id="index-high-level-design-of-lab-scenario">High Level Design of Lab scenario</h2>
<p>The Lab excercise is about showing you practical use of stretching services between on-prem and Public Cloud leveraging Cisco Nexus Dashboard Orchestrator and CNC for it.
It gives you oportunity to check how easy can be maintaining your services in different places due to scalibility, costs, performance using Cisco Cloud products.
Figure below is showing Logical design you are going to deploy in the Lab. Infrastructure part is already deployed, you don't need to bother with NDO installation, CNC installation or day-1 configs. This lab is solely to familiraze you with deployment of logical topology from the figure.</p>
<div class="admonition info">
<p class="admonition-title">Info</p>
<p>Lab is based on Cisco ACI simulator, thus it won't be possible to run Data-plane between on-prem and AWS. 
If you are interested to deploy all infra in MultiCloud, please join our <strong>Instructor Led Lab LTRCLD-2557</strong>.</p>
</div>
<p><strong>Lab diagram:</strong></p>
<p><img src="https://raw.githubusercontent.com/marcinduma/LABDCN-2542/master/images/image1a.png" width = 800></p>
<p>As indicated in the diagram, this lab is using EMEA based regions in AWS as well as dCloud (onprem). </p>
<p>POD runs on dedicated AWS infrastructure tenant which is already deployed and contains CNC and Cat8kv routers. Additionally each POD have dedicated AWS user tenant, its place where Policy model will be deployed.
Onprem, Lab infrastructure contains Cisco Nexus Dashboard with Nexus Dashboard Orchestrator, Cisco ACI infrastructure and CSR1kv to terminate IPSec tunnels.</p>
<p>Control plane infrastructure is already deployed for this lab. Use cases will be deployed in user tenant which needs to be onboarded in Cisco Network Controller and Nexus Dashboard Orchestrator.</p>
<p><strong><p style="text-align: center;">Enjoy!</p></strong></p></section><section class="print-page" id="lab_access-rdp"><h1 id="lab_access-rdp-lab-access">Lab access</h1>
<h2 id="lab_access-rdp-1-lab-access-general-description">1. Lab access general description</h2>
<p>The lab has been built leveraging multiple environments as following:</p>
<ul>
<li>Amazon Web Services</li>
<li>Private intrastructure on-prem</li>
</ul>
<p>You will have access to Cisco dCloud Workstation, where you will be able to open WEB GUI to:</p>
<ul>
<li>Cisco Nexus Dashboard/NDO onprem</li>
<li>Cisco APIC onprem</li>
<li>Cisco Network Controller (CNC) - hosted in AWS</li>
</ul>
<h2 id="lab_access-rdp-2-vpn-connection-to-dcloud-infrastructure">2. VPN connection to dCloud infrastructure</h2>
<p>The entire lab for the session is built using Cisco dCloud environment.
Details of the session are provided in POD assigned to you. You will find there "Connect VPN" link which allow you connection to dCloud session.
When you decide to use BYOD, please connect to VPN using provided credentials in WIL assistant webpage.</p>
<h3 id="lab_access-rdp-access-session-with-rdp">Access session with RDP</h3>
<p>Once logged to the dCloud session, you will be able to RDP Windows workstation ready to use for you</p>
<p>Open RDP client and use credentials provided below:</p>
<p>IP Address:</p>
<div class="highlight"><pre><span></span><code>198.18.133.36
</code></pre></div>
<p>Username:</p>
<div class="highlight"><pre><span></span><code>dcloud\demouser
</code></pre></div>
<p>User password:</p>
<div class="highlight"><pre><span></span><code>C1sco12345
</code></pre></div>
<p>When you login to Remote Desktop, you will find installed Chrome as web browser, from where you get access to GUI resources.</p>
<h2 id="lab_access-rdp-1-accessing-cisco-nexus-dashboardndo">1. Accessing Cisco Nexus Dashboard/NDO</h2>
<p>Once you are connected to RDP workstation, please open Chrome and by using Bookmark bar select <strong><em>Nexus Dashboard</em></strong>.</p>
<p>IP Address:</p>
<div class="highlight"><pre><span></span><code>198.18.134.200
</code></pre></div>
<p>Username:</p>
<div class="highlight"><pre><span></span><code>admin
</code></pre></div>
<p>User password:</p>
<div class="highlight"><pre><span></span><code>C1sco12345
</code></pre></div>
<h2 id="lab_access-rdp-2-accessing-cisco-apic">2. Accessing Cisco APIC</h2>
<p>Once you are connected to RDP workstation, please open Chrome and by using Bookmark bar select <strong><em>APIC</em></strong>.</p>
<p>IP Address:</p>
<div class="highlight"><pre><span></span><code>198.18.133.200
</code></pre></div>
<p>Username:</p>
<div class="highlight"><pre><span></span><code>admin
</code></pre></div>
<p>User password:</p>
<div class="highlight"><pre><span></span><code>C1sco12345
</code></pre></div>
<h2 id="lab_access-rdp-3-accessing-cisco-cloud-network-controller-cnc">3. Accessing Cisco Cloud Network Controller (CNC)</h2>
<p>IP Address of your CNC will be provided during the lab in later stage. Each Pod has its own CNC, please open Chrome and by using Bookmark bar select <strong><em>Cloud Network Controller</em></strong>. Credentials to login are same for all of them:</p>
<p>Username:</p>
<div class="highlight"><pre><span></span><code>admin
</code></pre></div>
<p>User password:</p>
<div class="highlight"><pre><span></span><code>CiscoLive2@23!
</code></pre></div>
<h2 id="lab_access-rdp-4-accessing-aws-console">4. Accessing AWS Console</h2>
<p>Your access to AWS User tenant per POD</p>
<p>AWS console login link:</p>
<p><a href="https://console.aws.amazon.com" target="_blank">https://console.aws.amazon.com</a></p>
<p>Azure portal login link: </p>
<p><a href="https://portal.azure.com" target="_blank">https://portal.azure.com</a></p>
<p>Information about account details as well as credentials are available in per POD sections listed in table below. Make sure to use corresponding POD ID from WiL dashboard.  </p>
<table>
<thead>
<tr>
<th>Attendee Name</th>
<th>POD ID</th>
<th>POD access details</th>
</tr>
</thead>
<tbody>
<tr>
<td>Student 1</td>
<td>POD1</td>
<td><a href="#pod1x.md">Lab Details POD1</a></td>
</tr>
<tr>
<td>Student 2</td>
<td>POD2</td>
<td><a href="#pod1x.md">Lab Details POD2</a></td>
</tr>
<tr>
<td>Student 3</td>
<td>POD3</td>
<td><a href="#pod1x.md">Lab Details POD3</a></td>
</tr>
</tbody>
</table></section>
                        <h1 class='nav-section-title' id='section-explore-nexus-dashboard'>
                            Explore Nexus Dashboard <a class='headerlink' href='#section-explore-nexus-dashboard' title='Permanent link'>↵</a>
                        </h1>
                        <section class="print-page" id="nd"><h1 id="nd-infrastructure-configuration-multisite-configuration">Infrastructure configuration - MultiSite configuration</h1>
<p>This lab section describes Nexus Dashboard functionalities. </p>
<h2 id="nd-nexus-dashboard-nd">Nexus Dashboard (ND)</h2>
<p>Cisco Nexus Dashboard is a single launch point to monitor and scale across different sites, whether it is Cisco Application Centric Infrastructure™ (Cisco ACI®) fabric controllers, the Cisco® Application Policy Infrastructure Controller (APIC), Cisco Nexus Dashboard Fabric Controller (NDFC), or a Cloud APIC running in a public cloud provider environment. Cisco NX-OS with Cisco Nexus Dashboard Fabric Controller (NDFC) – formerly Cisco Data Center Network Manager (Cisco DCNM) – is available as a service on the Cisco Nexus Dashboard. With third-party services integrated in Nexus Dashboard, NetOps can achieve command and control over global network fabrics, optimizing performance and attaining insights into data center and cloud operations. Using Cisco Nexus Dashboard, DevOps can improve the application deployment experience for multicloud applications Infrastructure-as-Code (IaC) integrations. Developers describe in code the networking components and resources needed to run an application in a data center or cloud.</p>
<p><img src="https://raw.githubusercontent.com/marcinduma/LABDCN-2542/master/images/nexus-dashboard-aag_0.png" width = 800></p>
<h3 id="nd-nexus-dashboard-overview">Nexus Dashboard overview</h3>
<p>Go to dCloud RDP workstation. Open Chrome web browser and from bookmarks select <strong><em>Nexus Dashboard</em></strong>. Connect with login credentials:</p>
<p>Username:</p>
<div class="highlight"><pre><span></span><code>admin
</code></pre></div>
<p>User password:</p>
<div class="highlight"><pre><span></span><code>C1sco12345
</code></pre></div>
<p>After login to your Nexus Dashboard, you will land in "One view" section. It is usually a world map or table with your sites configured to be maintain from ND.</p>
<p><img src="https://raw.githubusercontent.com/marcinduma/LABDCN-2542/master/images/nd-oneview-1.png" width = 800></p>
<p>You can zoom in/out to see it more in details. </p>
<p>By changing the view to table by using <em>slider</em> marked in figure above, you will have such details on the screen. <strong><em>Launch</em></strong> link will open you APIC/CNC GUI in new web browser tab.</p>
<p><img src="https://raw.githubusercontent.com/marcinduma/LABDCN-2542/master/images/nd-oneview-2.png" width = 800></p>
<p>By Clicking on <strong>Admin Console</strong> on Left navigation panel (marked red on figure above), you will be moved to System Overview Dashboard. Here you find information about your sites as well as Nexus Dashboard server status. You can check whether system is healthy, how many nodes in ND cluster you have, how many PODs/Deployments and Services are up and running. Simple graphical monitoring of entire system in one place.</p>
<p><img src="https://raw.githubusercontent.com/marcinduma/LABDCN-2542/master/images/nd-oneview-3.png" width = 800></p>
<p>To explore more, you can click on Left Navigation panel to find out details information about Nexus Dashboard:</p>
<ul>
<li>Sites - sites configured to be maintain by ND cluster</li>
<li>Services - Services installed on Nexus Dashboard - in our case Orchestrator (NDO)</li>
<li>System Resources - details about ND cluster - PODs/Deployments/Services, etc</li>
<li>Operations - Firmware management, backups, etc</li>
<li>Infrastructure - ND infra</li>
<li>Administrative - AAA configuration</li>
</ul>
<p>In next section you will explore Nexus Dashboard Orchestrator - service which is running on ND cluster.</p></section><section class="print-page" id="ndo"><h1 id="ndo-nexus-dashboard-orchestratorndo">Nexus Dashboard Orchestrator(NDO)</h1>
<p><strong>Cisco Nexus Dashboard Orchestrator (NDO)</strong> provides consistent network and policy orchestration, scalability, and disaster recovery across multiple data centers through a single pane of glass while allowing the data center to go wherever the data is.</p>
<p>NDO allows you to interconnect separate Cisco® Application Centric Infrastructure (Cisco ACI®) sites, Cisco Cloud ACI sites, and Cisco Nexus Dashboard Fabric Controller (NDFC) sites, each managed by its own controller (APIC cluster, NDFC cluster, or Cloud Network Controller instances in a public cloud). The on-premises sites (ACI or NDFC in the future) can be extended to different public clouds for hybrid-cloud deployments while cloud-first installations can be extended to multi-cloud deployments without on-premises sites. </p>
<p>The single-pane network interconnect policy management and the consistent network workload and segmentation policy provided by NDO allows monitoring the health of the interconnected fabrics, enforcement of segmentation and security policies, and performance of all tasks required to define tenant intersite policies in APIC, NDFC, and CNC sites. </p>
<p><img src="https://raw.githubusercontent.com/marcinduma/LABDCN-2542/master/images/image23a.png" width = 800></p>
<h3 id="ndo-key-features-and-benefits">Key features and benefits</h3>
<ul>
<li>
<p>Single pane of glass for administration and orchestration of multiple networking fabrics for both Cisco ACI and NDFC</p>
</li>
<li>
<p>Automation of the configuration and management of intersite network interconnects across an IP backbone for both Cisco ACI and NDFC</p>
</li>
<li>
<p>Consistent multitenant policy across multiple sites, which allows IP mobility, disaster recovery, and active/active use cases for data centers</p>
</li>
<li>
<p>Capability to map tenants, applications, and associated networks to specific availability domains within the Cisco Multi-Site architecture for both Cisco ACI and NDFC</p>
</li>
<li>
<p>Hybrid cloud and multi-cloud orchestration supporting on-premises Cisco ACI sites and public cloud sites (AWS and Azure)</p>
</li>
<li>
<p>Capability to have multi-cloud ACI deployments without on-premises sites</p>
</li>
<li>
<p>Scale out sites and leaf switches based on resource growth</p>
</li>
</ul>
<h3 id="ndo-use-cases">Use cases</h3>
<p>There are several uses of Cisco Nexus Dashboard Orchestrator. Some of the main use cases include:</p>
<ul>
<li>
<p>Large scale data center deployment</p>
</li>
<li>
<p>Data center interconnectivity</p>
</li>
<li>
<p>Cisco NDO multi-domain integrations</p>
</li>
<li>
<p>Hybrid cloud and multi-cloud</p>
</li>
<li>
<p>Service provider – 5G telco</p>
</li>
</ul>
<p><strong>Let's now explore possibilites of Cisco Nexus Dashboard Orchestrator!</strong></p>
<h3 id="ndo-1-ndo-service-introduction">1. NDO Service Introduction</h3>
<p>While you are connected to Nexus Dashboard GUI, now you will explore NDO dashboard. Follow the instructions.</p>
<p><strong>Nexus Dashboard Orchestrator</strong> is already installed and enabled under <strong>"Service Catalog"</strong> inside <strong>"Installed Service"</strong> </p>
<p><img src="https://raw.githubusercontent.com/marcinduma/LABDCN-2542/master/images/image27.png" width = 800></p>
<p>Hit <strong>"Open"</strong> button in order to login </p>
<p><img src="https://raw.githubusercontent.com/marcinduma/LABDCN-2542/master/images/image28.png" width = 400></p>
<p>You will be now redirected to <strong>Nexus Dashboard Orchestrator</strong> Dashboard. </p>
<h3 id="ndo-2-ndo-overview">2. NDO Overview</h3>
<p>NDO Dashboard is very similar to ND Dashboard. You will see world map with sites located on them. You can change view to <em>Table</em> and get such summary on the screen.</p>
<p><img src="https://raw.githubusercontent.com/marcinduma/LABDCN-2542/master/images/ndo-overview-1.png" width = 800></p>
<p>Similar to ND, Left navigation panel is divided to sections. You can find there:</p>
<ul>
<li>Sites - sites enablement under NDO. Sites are configured in ND itself but to be <strong>Managed</strong> by NDO must be explicitly configured in NDO Sites menu.</li>
</ul>
<p><img src="https://raw.githubusercontent.com/marcinduma/LABDCN-2542/master/images/ndo-overview-2.png" width = 800></p>
<ul>
<li>Application Management - under this section you find all components for Logical deployment of tenants. You will use this section while configuring Use-Cases in a moment.</li>
<li>Fabric Management - configuration of Fabric and Access Polices to be apply at sites</li>
<li>Operations - Backup/Restore/Updates etc</li>
<li>Infrastructure - Site connectivity - definition of overlay-1 VXLAN evpn, OSPF, eBGP - described on next section</li>
<li>Integration - Possibile integration with SDWAN or DNAC</li>
</ul>
<p>On next page you will look on config definition for Inter-site communication.</p></section><section class="print-page" id="infra-config"><h1 id="infra-config-site-connectivity-configuration">Site Connectivity Configuration</h1>
<p>In Next Step will be verification of our Infrastructure connectivity.</p>
<p>Navigate to <strong>Infrastructure</strong> -&gt; <strong>Site Connectivity</strong> -&gt; <strong>Configure</strong> button</p>
<p><img src="https://raw.githubusercontent.com/marcinduma/LABDCN-2542/master/images/image33.png" width = 800></p>
<p>On the <strong>General Settings</strong> Page, normally you will configure your global settings for entire MultiSite interconnection. Here you have BGP as well as OSPF polices, which will be deployed to every Site specified on the Left.</p>
<p><img src="https://raw.githubusercontent.com/marcinduma/LABDCN-2542/master/images/image34.png" width = 800></p>
<p>General Settings section is divided to four different tabs. Each of tab is important to fill with correct data. IPN devices and External devices tabs contains information about IPN onprem as well as Cloud Cat8k devices respectively. Those informations are then used to creation of configuration to be deployed on onprem IPN devices and Cat8kv. At last tab - IPSec Tunnel Subnet pools, contains details about Site to Site connection types.</p>
<p>Go to tab <strong>"IPSec Tunnel Subnet Pools"</strong>, to specify your IPSec details for securing communication across public Internet.</p>
<p><img src="https://raw.githubusercontent.com/marcinduma/LABDCN-2542/master/images/image40.png" width = 800></p>
<p>You may notice that there is already one subnet 169.254.0.0/16 configured, which is used for Tunnel addresing between Cloud Routers and Cloud Load Balancers(Azure)/Transit Gateways(AWS). Those tunnles are used to forward traffic from Cloud instances to Cloud Routers and further to another sites.
Second subnet 192.168.255.0/24 is used to address Tunnel interfaces between Sites in our case onpmrem CSR1kv router and Cat8kv routers in AWS.</p>
<p>In the left navigation bar, under the Sites bar, click on first site <strong>cAPIC</strong></p>
<p><img src="https://raw.githubusercontent.com/marcinduma/LABDCN-2542/master/images/image35.png" width = 200></p>
<p>You can verify site configuration on right side of the screen. Those information needs to be there.</p>
<div class="highlight"><pre><span></span><code>Settings:
- ACI Multisite - checked 
- Contract Based Routing - checked
- Inter-Site connectivity - on-prem selected (BGP-EVPN)
- Connection Type: Public
</code></pre></div>
<p>On-prem site have more information to define. All of them are deployed already to the site.</p>
<div class="admonition info">
<p class="admonition-title">Info</p>
<p>You can explore rest of the Site connectivity sections by yourself or move to Logical configuration on the next page.</p>
</div>
<p><strong>In Next Section our First Tenant will be configured!</strong></p></section><h1 class='nav-section-title-end'>Ended: Explore Nexus Dashboard</h1><section class="print-page" id="object-map"><h1 id="object-map-aci-to-public-cloud-object-mapping">ACI to Public Cloud object mapping</h1>
<p>Before you move to configuration spend a moment at Policy Object mapping between ACI onprem and AWS.</p>
<p>Cloud Netowrk Controller is using cloud native objects to map ACI constructins into various of public clouds. </p>
<h2 id="object-map-aci-to-aws-object-mapping">ACI to AWS object mapping</h2>
<p>Below you can find how ACI policy model is mapped to AWS cloud native objects </p>
<p><img src="https://raw.githubusercontent.com/marcinduma/LTRCLD-2557/master/images/aws_object_mapping.png" width = 1000></p></section>
                        <h1 class='nav-section-title' id='section-tenant-configuration'>
                            Tenant configuration <a class='headerlink' href='#section-tenant-configuration' title='Permanent link'>↵</a>
                        </h1>
                        <section class="print-page" id="ndo-tenant"><h1 id="ndo-tenant-nexus-dasboard-orchestrator-tenant-configuration">Nexus Dasboard Orchestrator Tenant configuration</h1>
<p>In this section you will configure your first Tenant, stretched between AWS and onprem.  </p>
<p>Following diagram shows what is to about to be configured. </p>
<p><img src="https://raw.githubusercontent.com/marcinduma/LABDCN-2542/master/images/image49a.png" width = 800></p>
<h2 id="ndo-tenant-tenant-creation-on-ndo">Tenant Creation on NDO</h2>
<div class="admonition info">
<p class="admonition-title">Info</p>
<p>Configuration will be fully deployed from <strong><em>Nexus Dashboard Orchestrator</em></strong>. All activities - except AWS Trust - will be done at NDO GUI.</p>
</div>
<p>On the Left navigation page click <strong>"Application Management" -&gt; "Tenant"</strong> and then <strong>"Add Tenant"</strong></p>
<p><img src="https://raw.githubusercontent.com/marcinduma/LABDCN-2542/master/images/image50.png" width = 800></p>
<p>Fill in Tenant details for name and description </p>
<ul>
<li>Display Name: <strong>Tenant-01</strong></li>
<li>Descrption: <strong>CL23 AMS Tenant-01</strong></li>
</ul>
<p>Associate Tenant to both Sites by checking the checkbox next to it. </p>
<p><img src="https://raw.githubusercontent.com/marcinduma/LABDCN-2542/master/images/image51.png" width = 800></p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>For now you are not able to <strong>Save</strong> this configuration with red marking on AWS Site. Click the <strong>Pencil</strong> button at the end of the site line to complete configuration. </p>
<p>Additional setting are needed for CNC, so it knows which Tenant ID to use on AWS. </p>
</div>
<p><strong>cAPIC site configuration</strong></p>
<p>For AWS site we have 2 options - <strong>Untrusted</strong> with Cloud Access key and Secret or <strong>Trusted</strong>. In our case we would be using Trusted configuration. </p>
<p>Each Tenant created on NDO associated to AWS Cloud required sepearete Account ID on AWS site. You can find your in POD Details under following Appendix (<strong><em>OR ON RDP DESKTOP FILE</em></strong> to evaluate.)</p>
<p>Fill in with your POD <strong> AWS User-Account ID</strong> and select <strong>Access Type</strong> as <strong>Trusted</strong>, hit <strong>Save</strong>. </p>
<p><img src="https://raw.githubusercontent.com/marcinduma/LABDCN-2542/master/images/image53.png" width = 800></p>
<p>Now configuration can be saved, leave assocaited user list empty as there are no additional users and hit <strong>Save</strong>.</p>
<p>On the Tenant list you should see <strong>Tenant-01</strong> created an assigned to 2 Sites. </p>
<p><img src="https://raw.githubusercontent.com/marcinduma/LABDCN-2542/master/images/image54.png" width = 800></p>
<p>In next step we will make AWS trust configuration, so CNC can make changes to AWS objects. </p>
<p>You can find details about this process under <strong>Resources</strong> in <strong>Appendixes</strong> section of this Lab Guide. </p></section><section class="print-page" id="aws-trust"><h1 id="aws-trust-nexus-dasboard-orchestrator-tenant-aws-trust-configuration">Nexus Dasboard Orchestrator Tenant AWS Trust Configuration</h1>
<p>In previous step you have selected Tenant configuration Mode as Trusted, so now trust needs to be made for Cloud Network Controller to have access to AWS Account. </p>
<h2 id="aws-trust-aws-cloud-network-controller-login">AWS Cloud Network Controller Login</h2>
<p>Using the IP of AWS Cisco Cloud Network Controller (can be found in Chrome bookmarks), connect to CNC GUI for AWS instance.</p>
<p><img src="https://raw.githubusercontent.com/marcinduma/LABDCN-2542/master/images/image60.png" width = 300></p>
<p>Provide Credentials and hit <strong>Login</strong></p>
<ul>
<li>Username: admin </li>
<li>Password: CiscoLive2@23!</li>
</ul>
<p><img src="https://raw.githubusercontent.com/marcinduma/LABDCN-2542/master/images/image61.png" width = 800></p>
<p>Hit <strong>"Get started"</strong> to view Cloud Network Controller Dashboard. </p>
<p><img src="https://raw.githubusercontent.com/marcinduma/LABDCN-2542/master/images/image62.png" width = 800></p>
<p>Look on the <strong>Dashboard -&gt; Application Management -&gt; Tenants</strong>, we can see newly create tenant on the list. </p>
<p><img src="https://raw.githubusercontent.com/marcinduma/LABDCN-2542/master/images/image63.png" width = 800></p>
<p>Double-click the Tenant name <strong>"Tenant-01"</strong> to open it. </p>
<p>Under the <strong>AWS Account</strong> section there is warning related to our Trust configuration, along with the <strong>"Run the CloudFormation Template"</strong> hyperlink. </p>
<p><img src="https://raw.githubusercontent.com/marcinduma/LABDCN-2542/master/images/image64.png" width = 800></p>
<p>Click on the hyperlink to run CloudFormation Script. You will be then redirected to AWS console CloudFormation Stack configuration. </p>
<p>In this time you will be asked to login go AWS console if not done before. If already loged in, please continue to <strong>CloudFormation script in AWS</strong>.</p>
<h2 id="aws-trust-aws-user-account-login">AWS User Account Login</h2>
<p>Open AWS console via browser </p>
<div class="highlight"><pre><span></span><code>https://console.aws.amazon.com
</code></pre></div>
<p><img src="https://raw.githubusercontent.com/marcinduma/LABDCN-2542/master/images/image3.png" width = 400></p>
<p>Select IAM user, provide Account ID and hit "Next" </p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>For this login please use AWS User Account ID from POD details - Section <strong><em>Lab Access</em></strong>. Use data from POD# assigned to you in Wil Assistant portal or ask proctor for help.</p>
</div>
<p><img src="https://raw.githubusercontent.com/marcinduma/LABDCN-2542/master/images/image4.png" width = 300></p>
<p>Provide Username and password and hit "Sign In" </p>
<p><img src="https://raw.githubusercontent.com/marcinduma/LABDCN-2542/master/images/image5.png" width = 300></p>
<h2 id="aws-trust-cloudformation-script-in-aws">CloudFormation script in AWS</h2>
<p><img src="https://raw.githubusercontent.com/marcinduma/LABDCN-2542/master/images/image65.png" width = 800></p>
<p>All the parameters are already filled in, hit <strong>"Next"</strong> to continue. </p>
<p>In <strong>Specify stack details</strong> step - fill in stack name and hit <strong>"Next"</strong></p>
<ul>
<li>Stack Name: <strong>CNC-AWS-Trust</strong></li>
<li>Parameters: none</li>
</ul>
<p><img src="https://raw.githubusercontent.com/marcinduma/LABDCN-2542/master/images/image66.png" width = 800></p>
<p>In <strong>Configure stack options</strong> step - leave all options as default and hit <strong>"Next"</strong></p>
<p>In <strong>Review CNC-AWS-Trust</strong> step - leave all options as default, scroll down to <strong>"Capabilities"</strong> section and check the checkbox for resource creation and hit <strong>"Submit"</strong></p>
<p><img src="https://raw.githubusercontent.com/marcinduma/LABDCN-2542/master/images/image67.png" width = 800></p>
<p>After couple of seconds(use refresh button) - stack will be completed and we are good to go. </p>
<p><img src="https://raw.githubusercontent.com/marcinduma/LABDCN-2542/master/images/image68.png" width = 800></p>
<p>After AWS trust configuration you have your first Tenant ready to be used. In next section of the Lab you will procced to Use-Cases configuration. Two(2) use-cases you are about to configure are presenting typical real-life scenearios. </p></section><h1 class='nav-section-title-end'>Ended: Tenant configuration</h1>
                        <h1 class='nav-section-title' id='section-use-cases'>
                            Use-cases <a class='headerlink' href='#section-use-cases' title='Permanent link'>↵</a>
                        </h1>
                        <section class="print-page" id="use-case1"><h1 id="use-case1-use-case-01-stretched-vrf-with-epg-to-epg-communication">Use-case 01 - Stretched VRF with EPG to EPG communication</h1>
<p><img src="https://raw.githubusercontent.com/marcinduma/LABDCN-2542/master/images/uc-1.png" width = 800></p>
<p>First use-case task will focus on:</p>
<ul>
<li>Configuration of stretched VRF inside Tenant-01</li>
<li>VPC CIDR configuration in AWS</li>
<li>EPG configuration in both sides </li>
<li>EC2 creation and EPG assigment</li>
<li>Contract configuration to allow traffic flow </li>
</ul>
<h2 id="use-case1-schema-template-configuration">Schema, Template configuration</h2>
<p>All logical polices and configuration are done in Nexus Dashboard Orchestratod via Schemas and Templates. Each Schema can have multiple Templates, but Template can belong to only one Schema. Each Template is also assocaited to one and only one Tenant. Template to site association will also define to which fabric (on prem or cloud) configration will be pushed, therefore is the smallest logical unit you can decide where changes are deployed. </p>
<h3 id="use-case1-1-schema-creation">1. Schema creation</h3>
<p>Navigate to <strong>Dashboard -&gt; Application Management -&gt; Schemas</strong>, then hit <strong>"Add Schema"</strong> </p>
<p><img src="https://raw.githubusercontent.com/marcinduma/LABDCN-2542/master/images/image70.png" width = 800></p>
<p>Add Schema name and Description and hit <strong>"Add"</strong> button</p>
<ul>
<li>Name: <strong>Schema-T01</strong> </li>
<li>Description: <strong>Schema for Tenant-01</strong></li>
</ul>
<h3 id="use-case1-2-template-creation">2. Template creation</h3>
<p>Under the Schema-T01, let's create first Template with <strong>"Add New Template"</strong> button</p>
<p><img src="https://raw.githubusercontent.com/marcinduma/LABDCN-2542/master/images/image71.png" width = 800></p>
<p>For a Template type select <strong>"ACI Multi-Cloud"</strong> and hit <strong>"Add"</strong></p>
<p><img src="https://raw.githubusercontent.com/marcinduma/LABDCN-2542/master/images/image72.png" width = 800></p>
<p>On the right side of the template screen, we can customize the Tempalte Display Name, and also select Tenant. Add Display Name and Select a Tenant. </p>
<ul>
<li>Display Name: <strong>temp-stretch-01</strong></li>
<li>Tenant setting: <strong>Tenant-01</strong></li>
</ul>
<p><img src="https://raw.githubusercontent.com/marcinduma/LABDCN-2542/master/images/image73.png" width = 800></p>
<h3 id="use-case1-3-template-to-site-association">3. Template to site association</h3>
<p>For configuration in template to be deployed, appropriate sites need to be added. Sites added will decide to which fabric configuration will be pushed. </p>
<p>For <strong>temp-stretch-01</strong>, we want to add both on-prem and AWS sites. </p>
<p>To do it under the <strong>Template Properties</strong> locate the <strong>Actions</strong> button and hit <strong>Sites Associations</strong></p>
<p><img src="https://raw.githubusercontent.com/marcinduma/LABDCN-2542/master/images/image76.png" width = 800></p>
<p>Select both site <strong>on-prem</strong> and <strong>cAPIC</strong> and hit <strong>Ok</strong></p>
<p><img src="https://raw.githubusercontent.com/marcinduma/LABDCN-2542/master/images/image77.png" width = 800></p>
<h2 id="use-case1-vrf-epg-selectors-deployment">VRF, EPG, selectors deployment</h2>
<h3 id="use-case1-1-vrf-configuration">1. VRF Configuration</h3>
<p>Inside <strong>Schema-T01</strong>, inside <strong>temp-stretch-01</strong> add the VRF with <strong>"Add VRF"</strong> button under <strong>VRFs</strong> box</p>
<p><img src="https://raw.githubusercontent.com/marcinduma/LABDCN-2542/master/images/image74.png" width = 800></p>
<p>Add VRF Common Properties </p>
<ul>
<li>Display Name: <strong>VRF-01</strong> </li>
<li>Description: <strong>CL2023 Stretch VRF</strong></li>
</ul>
<p>Leave other as default. </p>
<p><img src="https://raw.githubusercontent.com/marcinduma/LABDCN-2542/master/images/image75.png" width = 800></p>
<p>As Tempalte was assocaited to both sites, we need to update details for each of them, to do so under <strong>temp-stretch-01</strong> expand <strong>"Template Properties"</strong> and go to <strong>"cAPIC"</strong> </p>
<p><img src="https://raw.githubusercontent.com/marcinduma/LABDCN-2542/master/images/image78.png" width = 800></p>
<p>Click on the <strong>"VRF-01"</strong> which opens <strong>Site specific properties</strong> for this <strong>cAPIC Site</strong></p>
<p><img src="https://raw.githubusercontent.com/marcinduma/LABDCN-2542/master/images/image79.png" width = 800></p>
<p>Under the <strong>"Template Properties"</strong> hit <strong>"Add Region"</strong> button and select <strong>Region</strong> from the list and then hit  <strong>"Add CIDRs"</strong> button </p>
<ul>
<li><strong>Region:</strong> eu-west-2</li>
</ul>
<p><img src="https://raw.githubusercontent.com/marcinduma/LABDCN-2542/master/images/image80.png" width = 800></p>
<p>Now we need to specify what subnet we would like to use in AWS cloud for that VPC. This subnet will be configure as VPC CIDR on AWS cloud and will be used for VM and endpoint addressing. </p>
<ul>
<li>CIDR: <strong>10.0.0.0/23</strong> </li>
</ul>
<p><img src="https://raw.githubusercontent.com/marcinduma/LABDCN-2542/master/images/image81.png" width = 800></p>
<p>Our CIDR also needs to be divided into subnets for respective <strong>Availability Zones (AZ)</strong> - hit <strong>"Add Subnet"</strong> to configure it. </p>
<p>We need to add subnet for a,b,c (number of AZ depends on the region), each subet needs to be confirmed with click on <strong>checkbox</strong> button.</p>
<p><img src="https://raw.githubusercontent.com/marcinduma/LABDCN-2542/master/images/image82.png" width = 800></p>
<p>Create subnet for all 3 AZ in our Region, use non-virtual zone. </p>
<ul>
<li><strong>Subnet:</strong> 10.0.0.0/25      <strong>Name:</strong> az-2a-subnet <strong>AZ:</strong> eu-west-2a</li>
<li><strong>Subnet:</strong> 10.0.0.128/25    <strong>Name:</strong> az-2b-subnet <strong>AZ:</strong> eu-west-2b</li>
<li><strong>Subnet:</strong> 10.0.1.0/25      <strong>Name:</strong> az-2c-subnet <strong>AZ:</strong> eu-west-2c</li>
</ul>
<p>When done, hit <strong>"Save"</strong> button to save subnet configuration. </p>
<p>We also want to connect our subnets to Catalys8000V routers, this is done via Hub Network (Transit Gateway in AWS) - check the checkbox for <strong>"Hub Network"</strong>, select <strong>Hub Network</strong> and also all add all <strong>Subnets</strong> created before. </p>
<ul>
<li>Hub Network: <strong>TGW-HUB</strong></li>
<li>Subnets: <strong>10.0.0.0/25, 10.0.0.128/25, 10.0.1.0/25</strong> </li>
</ul>
<p><img src="https://raw.githubusercontent.com/marcinduma/LABDCN-2542/master/images/image84.png" width = 800></p>
<p>Hit ok to finish configuration for <strong>cAPIC</strong> fabric.</p>
<div class="admonition info">
<p class="admonition-title">Info</p>
<p>AWS Transit Gateway(TGW) connects Amazon Virtual Private Clouds (VPCs) networks through a central hub. This connection simplifies network and puts an end to complex peering relationships. Transit Gateway acts as a highly scalable cloud router(don't be confused by naming - it's AWS internal cloud service and it's not related to Catalyst8000V routers which we also used call Cloud Routers). </p>
<p>In our case TGW are used to connect our <strong>User VPC</strong> with <strong>Infrastructure VPC</strong> where the Cloud Routers (Catalyst8000V) resides, this allows traffic flow between User Endpoints and Cloud Routes, so also for communication with another sites and also another AWS Regions. Selection of the subnet for Hub Network means that such subnet will be advertised to TGW, so traffic towards such subnet can flow. </p>
</div>
<p>Under <strong>temp-stretch-01</strong> expand <strong>"Template Properties"</strong> and go to <strong>"Template Properties"</strong> main settings. </p>
<p><img src="https://raw.githubusercontent.com/marcinduma/LABDCN-2542/master/images/image89.png" width = 800></p>
<p>When done <strong>"Deploy to sites"</strong> button will become active (blue) - click to deploy VRF to respective sites. </p>
<p><img src="https://raw.githubusercontent.com/marcinduma/LABDCN-2542/master/images/image90.png" width = 800></p>
<p>Nexus Dashboard will also show what changes are to be made. Review those and hit <strong>Deploy</strong> button to push configuration. </p>
<p><img src="https://raw.githubusercontent.com/marcinduma/LABDCN-2542/master/images/image91.png" width = 800></p>
<p>If all goes well, confirmation pop-up will get displayed on the screen. </p>
<p><img src="https://raw.githubusercontent.com/marcinduma/LABDCN-2542/master/images/image92.png" width = 800></p>
<p>At this point in both on-prem and AWS cloud, there will be VRF/VPC created.</p>
<h3 id="use-case1-2-vrf-verification">2. VRF verification</h3>
<p>In the browser, open AWS console page. From the Region list, make sure that you have London (eu-west-2) region selected. If not, switch to it. </p>
<p><img src="https://raw.githubusercontent.com/marcinduma/LABDCN-2542/master/images/image94.png" width = 800></p>
<p>Search for <strong>"VPC"</strong> resource in Search tool and open it. </p>
<p><img src="https://raw.githubusercontent.com/marcinduma/LABDCN-2542/master/images/image93.png" width = 800></p>
<p>You should have 2 VPCs created. </p>
<ul>
<li>context-[VRF-01]-addr-[10.0.0.0/23] - coresponding to NDO created VRF </li>
<li>default, without name, created automaticaly by AWS</li>
</ul>
<p><img src="https://raw.githubusercontent.com/marcinduma/LABDCN-2542/master/images/image95.png" width = 800></p>
<p>Let's check now VRF on on-prem APIC.</p>
<p>Open APIC GUI and go to Tenants section.</p>
<p><img src="https://raw.githubusercontent.com/marcinduma/LABDCN-2542/master/images/uc-1-tenants.png" width = 800></p>
<p>Double-click at <strong>Tenant-1</strong> to enter configuration of your freshly created Tenant - using deploy at NDO.</p>
<p>Go to Networking -&gt; VRFs to check if new VRF-01 is created.</p>
<p><img src="https://raw.githubusercontent.com/marcinduma/LABDCN-2542/master/images/uc-1-tenant-vrf-1.png" width = 800></p>
<p>As you can see, creation of new Tenant and VRF from NDO has been done successfully. Let's continue with next steps.</p>
<h3 id="use-case1-3-additional-template-creation">3. Additional Template creation</h3>
<p>As per our topology diagram, EPGs in each Site are separate. As current <strong>temp-stretch-01</strong> is associated with both sites. We need to create two(2) new templates in the <strong>Schema-T01</strong> schema, for on-prem and AWS cloud sites respectively. </p>
<p>Use the <strong>"Add new Template"</strong> and create 2 new templates with following names. Similar to first template from <strong>Actions</strong> menu associate to respective sites. </p>
<p><img src="https://raw.githubusercontent.com/marcinduma/LABDCN-2542/master/images/image-95a.png" width = 800></p>
<p><strong>AWS Template:</strong></p>
<ul>
<li>Template name: <strong>temp-AWS-01</strong></li>
<li>Template type: <strong>ACI Multi-Cloud</strong></li>
<li>Template Tenant: <strong>Tenant-01</strong></li>
<li>Site associated: <strong>cAPIC</strong></li>
</ul>
<p>Hit <strong>Save</strong> button to save the template. </p>
<p><strong>on-prem Template:</strong></p>
<ul>
<li>Template name: <strong>temp-on-prem-01</strong></li>
<li>Template type: <strong>ACI Multi-Cloud</strong> </li>
<li>Template Tenant: <strong>Tenant-01</strong></li>
<li>Site associated: <strong>on-prem</strong></li>
</ul>
<p>Hit <strong>Save</strong> button to save the template. </p>
<h3 id="use-case1-4-application-profile-and-epg-configuration-for-aws">4. Application Profile and EPG Configuration for AWS</h3>
<p>ACI in Cloud doesn't use the concept of <strong>Bridge Domain</strong>, they don't have any representation in Cloud, that's why IP ranges were defined as part of the VRF configuration. </p>
<p><strong>EPGs</strong> can be now created and attached to VRF directly. </p>
<p>Navigate to <strong>temp-AWS-01</strong> template using <strong>View</strong> dropdown menu. </p>
<p><img src="https://raw.githubusercontent.com/marcinduma/LABDCN-2542/master/images/image100.png" width = 800></p>
<p>Add <strong>Application Profile</strong> using <strong>Add Application Profile</strong> button. </p>
<p><img src="https://raw.githubusercontent.com/marcinduma/LABDCN-2542/master/images/image101.png" width = 800></p>
<ul>
<li>Display Name: <strong>AppProf-AWS-01</strong></li>
<li>Description: <strong>Application Profile CL 2023 AWS</strong></li>
</ul>
<p>Hit <strong>Save</strong></p>
<p>Under created <strong>Application Profile</strong> add <strong>EPG</strong></p>
<p><img src="https://raw.githubusercontent.com/marcinduma/LABDCN-2542/master/images/image102.png" width = 800></p>
<ul>
<li>Display Name: <strong>EPG-AWS-01</strong></li>
<li>Description: <strong>EPG AWS CL 2023</strong> </li>
<li>EPG Type: <strong>Application</strong> </li>
</ul>
<p>Skip the <strong>"On-Premises Properties"</strong> and click on <strong>"Cloud Properties"</strong> and select <strong>"Virtual Routing &amp; Forwarding"</strong> as <strong>"VRF-01"</strong>. </p>
<p><img src="https://raw.githubusercontent.com/marcinduma/LABDCN-2542/master/images/image103.png" width = 500></p>
<p>We also need to add <strong>Selector</strong>. Selectors are used in Public Cloud to assign Virtual Machines and Endpoints to correct EPG represented by a Security Group. Selector should be added Under <strong>Site Specific</strong> configuration for each EPG. </p>
<p>Thare can be different type of selectores: </p>
<ul>
<li>IP based </li>
<li>TAG based</li>
<li>Region Based </li>
<li>Custom </li>
</ul>
<div class="admonition info">
<p class="admonition-title">Info</p>
<p>Selectors should be designed in a way that's Instances/Service are matched by only one selector - different configuration will result in Fault. </p>
</div>
<p>In our case we will use <strong>IP based</strong> selectors. </p>
<p>Under <strong>Template Properties</strong> swtich to <strong>cAPIC</strong> Site, click on <strong>EPG-AWS-01</strong> and hit <strong>"Add Selector"</strong> button under the EPG Cloud Properties. </p>
<p><img src="https://raw.githubusercontent.com/marcinduma/LABDCN-2542/master/images/image104.png" width = 800></p>
<p>Selector details: </p>
<ul>
<li>Endpoint Selector Name: <strong>AWS-sel</strong></li>
<li>
<p>Expression: </p>
<ul>
<li>Type: <strong>IP address</strong></li>
<li>Operator: <strong>Equals</strong></li>
<li>Value: <strong>10.0.0.0/23</strong></li>
</ul>
</li>
</ul>
<p>Hit checkbox sign to save expression and then <strong>Ok</strong> to finish. </p>
<p><img src="https://raw.githubusercontent.com/marcinduma/LABDCN-2542/master/images/image105.png" width = 500></p>
<p>Under <strong>Template Properties</strong> swtich back to <strong>Template Properties</strong> and hit <strong>"Deploy to sites"</strong> and <strong>"Deploy"</strong>. </p>
<p>Once done confirmation will pop up on the screen. </p>
<p><img src="https://raw.githubusercontent.com/marcinduma/LABDCN-2542/master/images/image106.png" width = 500></p>
<h3 id="use-case1-5-application-profile-and-epg-configuration-for-on-prem-apic">5. Application Profile and EPG Configuration for on-prem APIC</h3>
<p>In onprem ACI deployment, EPG is still assigned to Bridge-Domain. Before you create EPG, please create new Bridge Domain.</p>
<p><strong>on-prem Template:</strong></p>
<ul>
<li>Bridge Domain name: <strong>BD-01</strong></li>
<li>VRF Name: <strong>VRF-01</strong> </li>
<li>Gateway IP: <strong>172.16.255.1/24</strong></li>
</ul>
<p>Navigate to <strong>temp-on-prem-01</strong> template using <strong>View</strong> dropdown menu.
Scroll down to <em>Brdige Domain</em> section and click on Add Bridge Domain </p>
<p><img src="https://raw.githubusercontent.com/marcinduma/LABDCN-2542/master/images/uc-1-bd-1.png" width = 800></p>
<p>To add Gateway IP, scroll down right configuration section. You will find Gateway IP, click <strong>Add Subnet</strong>.</p>
<p><img src="https://raw.githubusercontent.com/marcinduma/LABDCN-2542/master/images/uc-1-bd-subnet.png" width = 800></p>
<p>Add new Subnet, leave rest or properties as is.</p>
<p><img src="https://raw.githubusercontent.com/marcinduma/LABDCN-2542/master/images/uc-1-bd-subnet-1.png" width = 800></p>
<p>When Bridge Domain BD-01 is ready, Continue with Application profile and EPG.</p>
<p>Navigate to <strong>temp-on-prem-01</strong> template using <strong>View</strong> dropdown menu. </p>
<p>Add <strong>Application Profile</strong> using <strong>Add Application Profile</strong> button. </p>
<ul>
<li>Display Name: <strong>AppProf-01</strong></li>
<li>Description: <strong>Application Profile CL 2023</strong></li>
</ul>
<p>Hit <strong>Save</strong></p>
<p>Under created <strong>Application Profile</strong> add <strong>EPG</strong></p>
<ul>
<li>Display Name: <strong>EPG-on-prem-01</strong></li>
<li>Description: <strong>EPG CL 2023</strong> </li>
<li>EPG Type: <strong>Application</strong> </li>
</ul>
<p>Configure the <strong>"On-Premises Properties"</strong> and select <strong>"Bridge Domain"</strong> as <strong>"BD-01"</strong>. </p>
<p><img src="https://raw.githubusercontent.com/marcinduma/LABDCN-2542/master/images/image110.png" width = 800></p>
<p>Hit <strong>"Deploy to sites"</strong> and <strong>"Deploy"</strong>. </p>
<p><img src="https://raw.githubusercontent.com/marcinduma/LABDCN-2542/master/images/uc-1-onprem-deply-1.png" width = 800></p>
<p>Once done confirmation will pop up on the screen. </p>
<p><strong>At this point we have created Tenant, VRF, BD EPGs and selectors - let's now add security contracts.</strong></p>
<h2 id="use-case1-contract-configuration">Contract configuration</h2>
<h3 id="use-case1-1-filter-creation">1. Filter creation</h3>
<p>In order to create Contract, we need to have a filter which defines what type of traffis is allowed or denied under specyfic contract subject. Filter can define what ports and protocols are matched by specyfic rule.</p>
<p>Open Nexus Dashboard Orchestrator GUI then go to <strong>Application Management -&gt; Schemas -&gt; "Schema-T01"</strong> -&gt; open </p>
<p>Under View select <strong>"temp-stretch-01"</strong> and <strong>"Add filter"</strong> under <strong>Filter</strong> section. </p>
<p><img src="https://raw.githubusercontent.com/marcinduma/LABDCN-2542/master/images/image143.png" width = 800></p>
<ul>
<li>Display Name: <strong>permit-any</strong> </li>
</ul>
<p>Then click <strong>"Add entry"</strong> to define protocols and ports. </p>
<ul>
<li>Name: <strong>permit-any</strong> </li>
</ul>
<p>Leave rest setting as default - this will allow for all protocols and ports, but we could limit traffic to very specific conditions. </p>
<p><img src="https://raw.githubusercontent.com/marcinduma/LABDCN-2542/master/images/image144.png" width = 600></p>
<p>Hit <strong>Ok</strong> to save it. </p>
<h3 id="use-case1-2-contract-configuration">2. Contract configuration</h3>
<p>As contracts will be used to connect AWS EPG to on-prem EPG, contract should be created in stretched template so it's deployed in both sites. </p>
<p>Under View select <strong>"temp-stretch-01"</strong> and <strong>"Add contract"</strong> under <strong>Contract</strong> section. </p>
<p><img src="https://raw.githubusercontent.com/marcinduma/LABDCN-2542/master/images/image142.png" width = 800></p>
<p>Create two(2) contracts with following details: </p>
<ul>
<li>
<p>Contract <strong>con-AWS-01-to-onprem-01</strong> </p>
<ul>
<li>Display Name: <strong>con-AWS-01-to-onprem-01</strong> </li>
<li>Scope: <strong>VRF</strong></li>
<li>Apply both direction: <strong>yes</strong></li>
<li>Add Filter: <strong>permit-any</strong></li>
</ul>
</li>
</ul>
<p>Hit <strong>Save</strong> to finish contract configuration. </p>
<ul>
<li>
<p>Contract <strong>con-onprem-01-to-AWS-01</strong> </p>
<ul>
<li>Display Name: <strong>con-onprem-01-to-AWS-01</strong> </li>
<li>Scope: <strong>VRF</strong></li>
<li>Apply both direction: <strong>yes</strong></li>
<li>Add Filter: <strong>permit-any</strong></li>
</ul>
</li>
</ul>
<p><img src="https://raw.githubusercontent.com/marcinduma/LABDCN-2542/master/images/image146.png" width = 800></p>
<p>Hit <strong>Save</strong> to finish contract configuration. </p>
<p>Hit <strong>Deploy to sites</strong> for contracts to be pushed. </p>
<div class="admonition info">
<p class="admonition-title">Info</p>
<p>Even the checkbox for "Apply both direction" is enabled, we still need 2 contracts between Cloud EPGs. This configuration is coming from the fact that Consumed Contracts are adding Outbound/Outgoing rules and Provided Contracts are adding Inband/Incoming rules, so with one contract we would only allow for traffic to be initiated from consumer EPG. We could use the same contract in both direction (each EPG would then provide and consume the same contract), but it's not a best practice as may lead to unwanted traffic leaking and complicate troubleshooting. </p>
</div>
<h3 id="use-case1-2-contract-assigment-to-epgs">2. Contract assigment to EPGs</h3>
<p>Just creation of contract doesn't have any impact on the traffic. Contract needs to have at least one Provider EPG and one Consumer EPG to allow communication between them. </p>
<p>Under View select <strong>"temp-AWS-01"</strong> click on the <strong>EPG-AWS-01</strong> and under EPG specific setting locate <strong>Contract</strong> section</p>
<p><img src="https://raw.githubusercontent.com/marcinduma/LABDCN-2542/master/images/image150.png" width = 800></p>
<p>Hit <strong>"Add Contract"</strong> button and add the following</p>
<p>Contract 1: </p>
<ul>
<li>EPG: <strong>EPG-AWS-01</strong></li>
<li>Contract: <strong>con-AWS-01-to-onprem-01</strong></li>
<li>Type: <strong>provider</strong> </li>
</ul>
<p>Contract 2: </p>
<ul>
<li>EPG: <strong>EPG-AWS-01</strong></li>
<li>Contract: <strong>con-onprem-01-to-AWS-01</strong></li>
<li>Type: <strong>consumer</strong> </li>
</ul>
<p>Hit <strong>Deploy to sites</strong> for contracts to be applied to EPGs. </p>
<p>Under View select <strong>"temp-on-prem-01"</strong> click on the <strong>EPG-on-prem-01</strong> and under EPG specific setting locate <strong>Contract</strong> section</p>
<p>Hit <strong>"Add Contract"</strong> button and add the following</p>
<p>Contract 1: </p>
<ul>
<li>EPG: <strong>EPG-on-prem-01</strong></li>
<li>Contract: <strong>con-onprem-01-to-AWS-01</strong></li>
<li>Type: <strong>provider</strong> </li>
</ul>
<p>Contract 2: </p>
<ul>
<li>EPG: <strong>EPG-on-prem-01</strong></li>
<li>Contract: <strong>con-AWS-01-to-onprem-01</strong></li>
<li>Type: <strong>consumer</strong> </li>
</ul>
<p>Hit <strong>Deploy to sites</strong> for contracts to be applied to EPGs. </p>
<p><img src="https://raw.githubusercontent.com/marcinduma/LABDCN-2542/master/images/image151.png" width = 800></p>
<h2 id="use-case1-ec2vm-creation-and-verification">EC2/VM creation and verification</h2>
<p>Next step is creation of AWS EC2 Instance for EPG associacion verification. </p>
<h3 id="use-case1-1-aws-ec2-creation">1. AWS EC2 creation</h3>
<p>Login to AWS User tenant via https://console.aws.amazon.com and make sure that you have <strong>London/eu-west-2</strong> region selected.</p>
<p><img src="https://raw.githubusercontent.com/marcinduma/LABDCN-2542/master/images/image115.png" width = 300></p>
<p>To be able to launch and login to VM we need to have SSH key-pair created. </p>
<p>In the search bar type <strong>"key pairs"</strong> and select Key Pairs from Features list. </p>
<p><img src="https://raw.githubusercontent.com/marcinduma/LABDCN-2542/master/images/image118.png" width = 600></p>
<p>Hit <strong>"Create key pair"</strong> in top right corner and provide following settings: </p>
<ul>
<li>Name: <strong>AWS-key-pair</strong></li>
<li>Key pair type: <strong>RSA</strong></li>
<li>Private key file format: <strong>.pem</strong></li>
</ul>
<p><img src="https://raw.githubusercontent.com/marcinduma/LABDCN-2542/master/images/image119.png" width = 600></p>
<p>Hit "Create key pair" to finish. Once it's done key will be downloaded to your workstation. </p>
<p>In the search bar type <strong>"EC2"</strong> and select EC2 from Service list. </p>
<p><img src="https://raw.githubusercontent.com/marcinduma/LABDCN-2542/master/images/image116.png" width = 600></p>
<p>On the EC2 Dashboard locate <strong>"Launch instance"</strong> and hit <strong>"Launch instance"</strong> option. </p>
<p><img src="https://raw.githubusercontent.com/marcinduma/LABDCN-2542/master/images/image117.png" width = 600></p>
<p>Instance details:</p>
<ul>
<li>Name: <strong>VM-AWS-01</strong></li>
<li>Application and OS Images: <strong>Amazon Linux</strong></li>
<li>Architecture: <strong>64-bit</strong> </li>
<li>Instance type: <strong>t2.micro</strong> </li>
<li>Key pair(login): <strong>AWS-key-pair</strong> </li>
<li>
<p>Network settings (hit Edit to change):</p>
<ul>
<li>VPC: <strong>context-[VRF-01]-addr[10.0.0.0/23]</strong></li>
<li>subnet: <strong>subnet-[10.0.0.0/25]</strong></li>
<li>Auto-assign public IP: <strong>Enable</strong></li>
<li>Firewall (security groups): <strong>leave default</strong></li>
</ul>
</li>
<li>
<p>Other setting leave default </p>
</li>
</ul>
<p><img src="https://raw.githubusercontent.com/marcinduma/LABDCN-2542/master/images/image120.png" width = 800></p>
<p>Review summary and hit <strong>"Launch instance"</strong> to create Virtual Machine</p>
<p><img src="https://raw.githubusercontent.com/marcinduma/LABDCN-2542/master/images/image121.png" width = 400></p>
<p>It may take 3-5 minutes for instance to be ready. </p>
<h3 id="use-case1-2-aws-ec2-verification">2. AWS EC2 verification</h3>
<p>Go back to EC2 -&gt; Instances and locate your EC2 machine. Click on Instance-ID of you machine to open it. </p>
<p><img src="https://raw.githubusercontent.com/marcinduma/LABDCN-2542/master/images/image122.png" width = 800></p>
<ul>
<li>Verify that VPC ID is correct </li>
<li>Verify that subnet is correct </li>
<li>Verify that instance has correct <strong>Private IPv4 addressess"</strong> </li>
</ul>
<p>Note down IP address of EC2 instance, we will need it for verification. </p>
<p><img src="https://raw.githubusercontent.com/marcinduma/LABDCN-2542/master/images/image123.png" width = 800></p>
<p>Go to Security tab settings of VM and check that <strong>Security groups</strong> for you instance is the one related to <strong>EPG-AWS-01</strong> </p>
<p><img src="https://raw.githubusercontent.com/marcinduma/LABDCN-2542/master/images/image124.png" width = 800></p>
<div class="admonition info">
<p class="admonition-title">Info</p>
<p>This security group was created when EPG configuration was deployed towards AWS site. Instance interfaces were assigned to this EPG/Security Group based on the IP based Selector configured for this EPG. Cloud Network Controller is monitoring resources created in managed Tenants and it's automatically assigning Security groupes based on selectors. </p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>After EC2 instance startup it may take some time for CNC to change security group to correct one. If no selector is matched, EC2 will be assigned to default Cloud Network Controller Secuirty Group will all traffic denied. </p>
</div></section><section class="print-page" id="use-case2"><h1 id="use-case2-use-case-02-internet-gateway">Use-case 02 - Internet Gateway</h1>
<p><img src="https://raw.githubusercontent.com/marcinduma/LABDCN-2542/master/images/uc-2.png" width = 800></p>
<p><strong>In this task we will configure Internet Gateway in AWS cloud, so EC2 from EPG-AWS-01 are able to reach the Internet.</strong></p>
<p>Instances in AWS can access Internet in AWS cloud with help of Internet Gateway. An internet gateway is a horizontally scaled, redundant, and highly available VPC component that allows communication between VPC and the internet.</p>
<p>An internet gateway provides a target VPC route tables for internet-routable traffic. For communication using IPv4, the internet gateway also performs network address translation (NAT).</p>
<h2 id="use-case2-internet-gateway-as-external-epg">Internet Gateway as External EPG</h2>
<p>As all VPC aspects and routing are controller by Cloud Network Controller, also Internet Gateway(IGW) is configured with it's help. Internet Gateway is represented by well know ACI object - External EPG. </p>
<h3 id="use-case2-external-epg-configuration">External EPG configuration</h3>
<p>Open Nexus Dashboard Orchestrator GUI then go to <strong>Application Management -&gt; Schemas -&gt; "Schema-T01"</strong> -&gt; open </p>
<p>Under View select <strong>"temp-AWS-01"</strong> and hit <strong>"Add External EPGs"</strong> under <strong>External EPGs</strong> section. </p>
<p><img src="https://raw.githubusercontent.com/marcinduma/LABDCN-2542/master/images/image172.png" width = 800></p>
<ul>
<li>Display Name: <strong>ExtEPG-IGW</strong></li>
<li>Description: <strong>Ext EPG for Internet Gateway AWS</strong> </li>
<li>Virutal Routing &amp; Forwarding: <strong>VRF-01</strong> </li>
<li>Select Site Type: <strong>CLOUD</strong> </li>
</ul>
<p><img src="https://raw.githubusercontent.com/marcinduma/LABDCN-2542/master/images/image174.png" width = 500>   </p>
<ul>
<li>
<p>Cloud Properties: </p>
<ul>
<li>Application Profile: <strong>AppProf-AWS-01</strong></li>
<li>
<p>Add Selector: </p>
<ul>
<li>Endpoint Selector Name: <strong>Internet</strong></li>
<li>Expression Type: <strong>IP Address</strong></li>
<li>Expression Operator: <strong>Equal</strong></li>
<li>Expression Value: <strong>0.0.0.0/0</strong></li>
</ul>
</li>
</ul>
</li>
</ul>
<p><img src="https://raw.githubusercontent.com/marcinduma/LABDCN-2542/master/images/image173.png" width = 800>   </p>
<p>Hit <strong>Save</strong> to finish. </p>
<div class="admonition info">
<p class="admonition-title">Info</p>
<p>Adding the "0.0.0.0/0" subnet will add additional route to this prefix, pointing to internet gateway object create in AWS. In case only specific prefixes should be rechable, you can use differnt subnet that 0.0.0.0/0. </p>
</div>
<h3 id="use-case2-contract-configuration">Contract configuration</h3>
<p>As External EPG is functioning as any other EPG, contract configuration from EPG to External EPG is mandatory for traffic to be allowed. </p>
<h4 id="use-case2-1-filter-creation">1. Filter creation</h4>
<p>Open Nexus Dashboard Orchestrator GUI then go to <strong>Application Management -&gt; Schemas -&gt; "Schema-T01"</strong> -&gt; open </p>
<p>Under View select <strong>"temp-AWS-01""</strong> and <strong>"Add filter"</strong> under <strong>Filter</strong> section. </p>
<ul>
<li>Display Name: <strong>permit-any-aws</strong> </li>
</ul>
<p>Then click <strong>"Add entry"</strong> to define protocols and ports. </p>
<ul>
<li>Name: <strong>permit-any</strong> </li>
</ul>
<p>Leave rest setting as default - this will allow for all protocols and ports. </p>
<p><img src="https://raw.githubusercontent.com/marcinduma/LABDCN-2542/master/images/image144.png" width = 600></p>
<p>Hit <strong>Ok</strong> to save it. </p>
<h4 id="use-case2-2-contract-configuration">2. Contract configuration</h4>
<p>As contracts will be used to connect AWS EPG to ExtEPG of AWS, contract should be created in AWS template </p>
<p>Under View select <strong>"temp-AWS-01"</strong> and <strong>"Add contract"</strong> under <strong>Contract</strong> section. </p>
<p>Create two(2) contracts with following details: </p>
<ul>
<li>
<p>Contract <strong>con-AWS-01-to-IGW</strong> </p>
<ul>
<li>Display Name: <strong>con-AWS-01-to-IGW</strong> </li>
<li>Scope: <strong>VRF</strong></li>
<li>Apply both direction: <strong>yes</strong></li>
<li>Add Filter: <strong>permit-any-AWS</strong></li>
</ul>
</li>
</ul>
<p><img src="https://raw.githubusercontent.com/marcinduma/LABDCN-2542/master/images/image176.png" width = 800></p>
<p>Hit <strong>Save</strong> to finish contract configuration. </p>
<ul>
<li>
<p>Contract <strong>con-IGW-to-AWS-01</strong> </p>
<ul>
<li>Display Name: <strong>con-IGW-to-AWS-01</strong> </li>
<li>Scope: <strong>VRF</strong></li>
<li>Apply both direction: <strong>yes</strong></li>
<li>Add Filter: <strong>permit-any-AWS</strong></li>
</ul>
</li>
</ul>
<p><img src="https://raw.githubusercontent.com/marcinduma/LABDCN-2542/master/images/image175.png" width = 500></p>
<p>Hit <strong>Save</strong> to finish contract configuration. </p>
<p>Hit <strong>Deploy to sites</strong> for contracts to be pushed. </p>
<p><img src="https://raw.githubusercontent.com/marcinduma/LABDCN-2542/master/images/uc-2-deploy-1.png" width = 800></p>
<div class="admonition info">
<p class="admonition-title">Info</p>
<p>Having contract only in one direction where Internet Gateway is a provider will be enough for EC2 instances to reach Internet, however contract in opposite direction is needed in case you want to connect to EC2 instances Public IPv4 Addresses from Internet. </p>
</div>
<h4 id="use-case2-3-contract-assigment-to-epgs">3. Contract assigment to EPGs</h4>
<p>Under View select <strong>"temp-AWS-01"</strong> click on the <strong>EPG-AWS-01</strong> and under EPG specific setting locate <strong>Contract</strong> section</p>
<p>Hit <strong>"Add Contract"</strong> button and add the following</p>
<p>Contract 1: </p>
<ul>
<li>EPG: <strong>EPG-AWS-01</strong></li>
<li>Contract: <strong>con-AWS-01-to-IGW</strong>*</li>
<li>Type: <strong>provider</strong> </li>
</ul>
<p>Contract 2: </p>
<ul>
<li>EPG: <strong>EPG-AWS-01</strong></li>
<li>Contract: <strong>con-IGW-to-AWS-01</strong></li>
<li>Type: <strong>consumer</strong> </li>
</ul>
<p><img src="https://raw.githubusercontent.com/marcinduma/LABDCN-2542/master/images/image177.png" width = 800></p>
<p>Under View select <strong>"temp-AWS-01"</strong> click on the <strong>ExtEPG-IGW</strong> and under <strong>Common Properties</strong> locate <strong>Contract</strong> section</p>
<p>Hit <strong>"Add Contract"</strong> button and add the following</p>
<p>Contract 1: </p>
<ul>
<li>EPG: <strong>ExtEPG-IGW</strong></li>
<li>Contract: <strong>con-IGW-to-AWS-01</strong></li>
<li>Type: <strong>provider</strong> </li>
</ul>
<p>Contract 2: </p>
<ul>
<li>EPG: <strong>ExtEPG-IGW</strong></li>
<li>Contract: <strong>con-AWS-01-to-IGW</strong></li>
<li>Type: <strong>consumer</strong> </li>
</ul>
<p><img src="https://raw.githubusercontent.com/marcinduma/LABDCN-2542/master/images/image178.png" width = 800></p>
<p>Hit <strong>Deploy to sites</strong> to create IGW and deploy contracts associations. </p>
<h2 id="use-case2-verification">Verification</h2>
<p>Let's check if AWS EC2 instance is now reachable from internet. </p>
<h3 id="use-case2-1-in-aws-search-bar-type-ec2-and-select-ec2-services-tab">1. In AWS Search Bar type "EC2" and Select "EC2" Services Tab</h3>
<p><img src="https://raw.githubusercontent.com/marcinduma/LABDCN-2542/master/images/image6.png" width = 800></p>
<h3 id="use-case2-2-from-resources-select-instances-running">2. From "Resources" select "Instances (Running)"</h3>
<p><img src="https://raw.githubusercontent.com/marcinduma/LABDCN-2542/master/images/image7.png" width = 800></p>
<p>Locate Public IPv4 Address of EC2 instance, either on the EC2 instance list or under Details section</p>
<p><img src="https://raw.githubusercontent.com/marcinduma/LABDCN-2542/master/images/image179.png" width = 800></p>
<p>From workstation open command line interface by hitting <strong>"Start"</strong> and typing <strong>"cmd"</strong></p>
<p><img src="https://raw.githubusercontent.com/marcinduma/LABDCN-2542/master/images/image180.png" width = 800></p>
<p>Execute command </p>
<div class="highlight"><pre><span></span><code>ping &lt;Public IPv4 address of EC2&gt;
</code></pre></div>
<p><img src="https://raw.githubusercontent.com/marcinduma/LABDCN-2542/master/images/image181.png" width = 800></p>
<p>Communication is successfull now, EC2 instance has access to Internet via AWS Internet Gateway. </p>
<p>At this point we completed that part of our topology configuration. </p>
<p><img src="https://raw.githubusercontent.com/marcinduma/LABDCN-2542/master/images/image185.png" width = 800></p>
<p>You successfully completed Walk in Lab scenarious. </p></section><h1 class='nav-section-title-end'>Ended: Use-cases</h1>
                        <h1 class='nav-section-title' id='section-appendixes'>
                            Appendixes <a class='headerlink' href='#section-appendixes' title='Permanent link'>↵</a>
                        </h1>
                        
                        <h2 class='nav-section-title' id='section-lab-details'>
                            Lab details <a class='headerlink' href='#section-lab-details' title='Permanent link'>↵</a>
                        </h2>
                        <h1 class='nav-section-title-end'>Ended: Lab details</h1><h1 class='nav-section-title-end'>Ended: Appendixes</h1></div>

              
            </article>
          </div>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    <script id="__config" type="application/json">{"base": "/", "features": [], "search": "assets/javascripts/workers/search.2a1c317c.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version.title": "Select version"}}</script>
    
    
      <script src="assets/javascripts/bundle.3a4b43e5.min.js"></script>
      
        <script src="js/print-site.js"></script>
      
    
  </body>
</html>